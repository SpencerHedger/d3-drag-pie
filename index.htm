<html>
    <head>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src="./js/d3-drag-pie.js"></script>
    
        <style>
            path.d3dp-segment {
                fill: whitesmoke;
                stroke: silver;
                stroke-dasharray: 5;
            }
            path.d3dp-segment-categories {
                stroke: black;
            }
        </style>

        <script>
            var d = [
                    { name: "Segment 1", value: 20,
                        categories: [
                            { id: 0, name: "Category 1", value: 20 },
                            { id: 1, name: "Category 2", value: 50 },
                            { id: 2, name: "Category 3", value: 10 }
                        ] },
                    { name: "Segment 2", value: 40,
                        categories: [
                            { id: 0, name: "Category 1", value: 30 },
                            { id: 1, name: "Category 2", value: 60 },
                            { id: 2, name: "Category 3", value: 10 }
                        ] },
                    { name: "Segment 3", value: 50,
                        categories: [
                            { id: 0, name: "Category 1", value: 40 },
                            { id: 1, name: "Category 2", value: 20 },
                            { id: 2, name: "Category 3", value: 10 }
                        ] },
                    { name: "Segment 4", value: 10,
                        categories: [
                            { id: 0, name: "Category 1", value: 10 },
                            { id: 1, name: "Category 2", value: 10 },
                            { id: 2, name: "Category 3", value: 50 }
                        ] },
                    { name: "Segment 5", value: 30,
                        categories: [
                            { id: 0, name: "Category 1", value: 50 },
                            { id: 1, name: "Category 2", value: 10 },
                            { id: 2, name: "Category 3", value: 20 }
                        ] }
                ];
            
            var n1 = null;

            function ready() {
                var dragpie = d3dp();

                n1 = dragpie.create({
                    target: document.getElementById('pie'),
                    data: d,
                    categoryColors: ["green", "violet", "red"],
                    segmentScaleMaximum: 100,
                    categoryScaleMaximum: 60,
                    accessors: {
                        getSegmentValue: function(seg) { return seg.value },
                        setSegmentValue: function(seg, value) { seg.value = value; },
                        getCategoryValue: function(cat) { return cat.value },
                        setCategoryValue: function(cat, value, seg) { cat.value = value; }
                    },
                    events: {
                        segment: {
                            mouseover: function(seg) { console.log(seg.name) },
                            click: function(seg) { console.log(seg.name) },
                            drag:  function(seg) { console.log(seg.name) }
                        },
                        category: {
                            mouseover: function(cat, seg) { console.log(seg.name + ' -> ' + cat.name) },
                            mouseout: function(cat, seg) { console.log(seg.name + ' -> ' + cat.name) },                            
                            click: function(cat, seg) { console.log(seg.name + ' -> ' + cat.name) },
                            drag:  function(cat, seg) { console.log(seg.name + ' -> ' + cat.name) }
                        }
                    }
                });
            }
        </script>
    </head>
    <body onload="ready();" >
        <div id="pie"></div>
    </body>
</html>